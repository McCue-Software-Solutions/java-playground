<!DOCTYPE html>
<html>
<head>
  <title>Java Playground</title>
  <link rel="stylesheet" href="stylesheet.css">
</head>
<body>
  <header>
    <h1>Java Playground</h1>
  </header>

  <div class="container">
    <textarea id="code" placeholder="Enter your Java code here" onkeydown="handleTabKey(event)"></textarea>
    <button onclick="runCode()">Run</button>
    <textarea id="output" readonly></textarea>
  </div>

  <script>
    function handleTabKey(event) {
      if (event.key === "Tab") {
        event.preventDefault(); // Prevent the default focus switching behavior

        var textarea = event.target;
        var start = textarea.selectionStart;
        var end = textarea.selectionEnd;

        // Insert a tab character at the current cursor position
        textarea.value = textarea.value.substring(0, start) + "\t" + textarea.value.substring(end);

        // Move the cursor position after the inserted tab character
        textarea.selectionStart = textarea.selectionEnd = start + 1;
      }
    }

    function runCode() {
      var code = document.getElementById("code").value;
      var outputTextArea = document.getElementById("output");
      outputTextArea.value = ""; // Clear previous output

      fetch('http://146.190.154.242:3000/run-code', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({code: code})
      })
      .then(response => response.json())
      .then(data => {
        if (data.stdout) outputTextArea.value += data.stdout;
        if (data.stderr) outputTextArea.value += "[Error] " + data.stderr;
        if (data.error) outputTextArea.value += "[Error] " + data.error;
      });
    }
  </script>
</body>
</html>
